import{_ as J,x as w,p as K,n as g,y as P,r as n,o as x,h as U,g as F,e,w as l,k as c,F as $,i as Q,d as R,E as X,A as B,B as Z}from"./index-BfrI5JCD.js";const ee={class:"user-header"},le={class:"table"},ae={__name:"User",setup(te){const k=w([]),{proxy:d}=K(),_=async()=>{let r=await d.$api.getUserData(f);k.value=r.list.map(a=>({...a,sexLabel:a.sex==="1"?"男":"女"})),f.total=r.count},D=g([{prop:"name",label:"姓名"},{prop:"age",label:"年龄"},{prop:"sexLabel",label:"性别"},{prop:"birth",label:"出生日期",width:200},{prop:"addr",label:"地址",width:400}]),h=g({keyWord:""}),f=g({name:"",total:0,page:1}),q=()=>{f.name=h.keyWord,_()},E=r=>{f.page=r,_()},M=r=>{X.confirm("你确定要删除吗?").then(async()=>{await d.$api.deleteUser({id:r.id}),B({showClose:!0,message:"删除成功",type:"success"}),_()})},y=w("add"),i=w(!1),o=g({sex:"1"}),L=g({name:[{required:!0,message:"姓名是必填项",trigger:"blur"}],age:[{required:!0,message:"年龄是必填项",trigger:"blur"},{type:"number",message:"年龄必须是数字"}],sex:[{required:!0,message:"性别是必填项",trigger:"change"}],birth:[{required:!0,message:"出生日期是必选项"}],addr:[{required:!0,message:"地址是必填项"}]}),W=()=>{i.value=!1,d.$refs.userForm.resetFields()},z=()=>{i.value=!1,d.$refs.userForm.resetFields()},I=()=>{i.value=!0,y.value="add"},N=a=>{var a=new Date(a),u=a.getFullYear(),p=a.getMonth()+1,s=a.getDate();function b(m){return m<10?"0"+m:m}return u+"-"+b(p)+"-"+b(s)},j=()=>{d.$refs.userForm.validate(async r=>{if(r){let a=null;o.birth=/^\d{4}-\d{2}-\d{2}$/.test(o.birth)?o.birth:N(o.birth),y.value==="add"?a=await d.$api.addUser(o):a=await d.$api.editUser(o),a&&(i.value=!1,d.$refs.userForm.resetFields(),_())}else B({showClose:!0,message:"请输入正确的内容",type:"error"})})},A=r=>{y.value="edit",i.value=!0,Z(()=>{Object.assign(o,{...r,sex:""+r.sex})})};return P(()=>{_()}),(r,a)=>{const u=n("el-button"),p=n("el-input"),s=n("el-form-item"),b=n("el-form"),m=n("el-table-column"),S=n("el-table"),T=n("el-pagination"),v=n("el-col"),V=n("el-row"),C=n("el-option"),O=n("el-select"),Y=n("el-date-picker"),G=n("el-dialog");return x(),U($,null,[F("div",ee,[e(u,{type:"primary",onClick:I},{default:l(()=>[c("新增")]),_:1}),e(b,{inline:!0,model:h},{default:l(()=>[e(s,{label:"请输入:"},{default:l(()=>[e(p,{placeholder:"请输入用户名",modelValue:h.keyWord,"onUpdate:modelValue":a[0]||(a[0]=t=>h.keyWord=t)},null,8,["modelValue"])]),_:1}),e(s,null,{default:l(()=>[e(u,{type:"primary",onClick:q},{default:l(()=>[c("搜索")]),_:1})]),_:1})]),_:1},8,["model"])]),F("div",le,[e(S,{data:k.value,style:{width:"100%"}},{default:l(()=>[(x(!0),U($,null,Q(D,t=>(x(),R(m,{key:t.prop,width:t.width?t.width:125,prop:t.prop,label:t.label},null,8,["width","prop","label"]))),128)),e(m,{fixed:"right",label:"操作","min-width":"120"},{default:l(t=>[e(u,{type:"primary",size:"small",onClick:H=>A(t.row)},{default:l(()=>[c(" 编辑 ")]),_:2},1032,["onClick"]),e(u,{type:"danger",size:"small",onClick:H=>M(t.row)},{default:l(()=>[c(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(T,{class:"pager",background:"",layout:"prev, pager, next",size:"small",total:f.total,onCurrentChange:E},null,8,["total"])]),e(G,{modelValue:i.value,"onUpdate:modelValue":a[6]||(a[6]=t=>i.value=t),title:y.value==="add"?"新增用户":"编辑用户",width:"35%","before-close":W},{default:l(()=>[e(b,{inline:!0,model:o,rules:L,ref:"userForm"},{default:l(()=>[e(V,null,{default:l(()=>[e(v,{span:12},{default:l(()=>[e(s,{label:"姓名",prop:"name"},{default:l(()=>[e(p,{modelValue:o.name,"onUpdate:modelValue":a[1]||(a[1]=t=>o.name=t),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),e(v,{span:12},{default:l(()=>[e(s,{label:"年龄",prop:"age"},{default:l(()=>[e(p,{modelValue:o.age,"onUpdate:modelValue":a[2]||(a[2]=t=>o.age=t),modelModifiers:{number:!0},placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(v,{span:12},{default:l(()=>[e(s,{class:"select-clearn",label:"性别",prop:"sex"},{default:l(()=>[e(O,{modelValue:o.sex,"onUpdate:modelValue":a[3]||(a[3]=t=>o.sex=t),placeholder:"请选择"},{default:l(()=>[e(C,{label:"男",value:"1"}),e(C,{label:"女",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(v,{span:12},{default:l(()=>[e(s,{label:"出生日期",prop:"birth"},{default:l(()=>[e(Y,{modelValue:o.birth,"onUpdate:modelValue":a[4]||(a[4]=t=>o.birth=t),type:"date",placeholder:"请输入",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(V,null,{default:l(()=>[e(s,{label:"地址",prop:"addr"},{default:l(()=>[e(p,{modelValue:o.addr,"onUpdate:modelValue":a[5]||(a[5]=t=>o.addr=t),placeholder:"请输入地址"},null,8,["modelValue"])]),_:1})]),_:1}),e(V,{style:{"justify-content":"flex-end"}},{default:l(()=>[e(s,null,{default:l(()=>[e(u,{type:"primary",onClick:j},{default:l(()=>[c("确认")]),_:1}),e(u,{type:"primary",onClick:z},{default:l(()=>[c("取消")]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}},ne=J(ae,[["__scopeId","data-v-97d447cd"]]);export{ne as default};
