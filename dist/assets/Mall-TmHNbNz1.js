import{_ as J,x as w,p as K,n as V,y as P,r as d,o as k,h as x,g as F,e,w as l,k as _,F as $,i as Q,d as R,E as X,A as U,B as Z}from"./index-BfrI5JCD.js";const ee={class:"mall-header"},le={class:"table"},ae={__name:"Mall",setup(te){const C=w([]),{proxy:s}=K(),f=async()=>{let n=await s.$api.getMallData(b);C.value=n.list.map(a=>({...a,specs:a.specs===1?"件":"箱"})),b.total=n.count},q=V([{prop:"bid",label:"商品编号",width:180},{prop:"name",label:"商品名称"},{prop:"specs",label:"规格",width:60},{prop:"price",label:"售价",width:80},{prop:"birth",label:"生产时间",width:120},{prop:"addr",label:"生产地址",width:300},{prop:"stock",label:"库存",width:60}]),y=V({keyWord:""}),b=V({name:"",total:0,page:1}),B=()=>{b.name=y.keyWord,f()},D=n=>{b.page=n,f()},E=n=>{X.confirm("你确定要删除吗?").then(async()=>{await s.$api.deleteMall({id:n.id}),U({showClose:!0,message:"删除成功",type:"success"}),f()})},v=w("add"),i=w(!1),o=V({sex:"1"}),W=V({bid:[{required:!0,message:"必填项"}],name:[{required:!0,message:"必填项",trigger:"blur"}],specs:[{required:!0,message:"必填项",trigger:"change"}],price:[{required:!0,message:"必填项"}],stock:[{required:!0,message:"必填项"}],addr:[{required:!0,message:"必填项"}],birth:[{required:!0,message:"必选项"}]}),z=()=>{i.value=!1,s.$refs.mallForm.resetFields()},I=()=>{i.value=!1,s.$refs.mallForm.resetFields()},N=()=>{i.value=!0,v.value="add"},j=()=>{s.$refs.mallForm.validate(async n=>{if(n){let a=null;o.birth=/^\d{4}-\d{2}-\d{2}$/.test(o.birth)?o.birth:A(o.birth),v.value==="add"?a=await s.$api.addMall(o):a=await s.$api.editMall(o),a&&(i.value=!1,s.$refs.mallForm.resetFields(),f())}else U({showClose:!0,message:"请输入正确的内容",type:"error"})})},A=a=>{var a=new Date(a),u=a.getFullYear(),p=a.getMonth()+1,r=a.getDate();function g(m){return m<10?"0"+m:m}return u+"-"+g(p)+"-"+g(r)},L=n=>{v.value="edit",i.value=!0,Z(()=>{Object.assign(o,{...n,specs:""+n.specs})})};return P(()=>{f()}),(n,a)=>{const u=d("el-button"),p=d("el-input"),r=d("el-form-item"),g=d("el-form"),m=d("el-table-column"),S=d("el-table"),T=d("el-pagination"),c=d("el-col"),M=d("el-option"),O=d("el-select"),h=d("el-row"),Y=d("el-date-picker"),G=d("el-dialog");return k(),x($,null,[F("div",ee,[e(u,{type:"primary",onClick:N},{default:l(()=>[_("新增")]),_:1}),e(g,{inline:!0,model:y},{default:l(()=>[e(r,{label:"请输入:"},{default:l(()=>[e(p,{placeholder:"请输入商品名称",modelValue:y.keyWord,"onUpdate:modelValue":a[0]||(a[0]=t=>y.keyWord=t)},null,8,["modelValue"])]),_:1}),e(r,null,{default:l(()=>[e(u,{type:"primary",onClick:B},{default:l(()=>[_("搜索")]),_:1})]),_:1})]),_:1},8,["model"])]),F("div",le,[e(S,{data:C.value,style:{width:"100%"}},{default:l(()=>[(k(!0),x($,null,Q(q,t=>(k(),R(m,{key:t.prop,width:t.width?t.width:125,prop:t.prop,label:t.label},null,8,["width","prop","label"]))),128)),e(m,{fixed:"right",label:"操作","min-width":"120"},{default:l(t=>[e(u,{type:"primary",size:"small",onClick:H=>L(t.row)},{default:l(()=>[_(" 编辑 ")]),_:2},1032,["onClick"]),e(u,{type:"danger",size:"small",onClick:H=>E(t.row)},{default:l(()=>[_(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(T,{class:"pager",background:"",layout:"prev, pager, next",size:"small",total:b.total,onCurrentChange:D},null,8,["total"])]),e(G,{modelValue:i.value,"onUpdate:modelValue":a[8]||(a[8]=t=>i.value=t),title:v.value==="add"?"新增商品":"编辑商品",width:"35%","before-close":z},{default:l(()=>[e(g,{inline:!0,model:o,rules:W,ref:"mallForm"},{default:l(()=>[e(h,null,{default:l(()=>[e(c,{span:12},{default:l(()=>[e(r,{label:"商品编号",prop:"bid"},{default:l(()=>[e(p,{modelValue:o.bid,"onUpdate:modelValue":a[1]||(a[1]=t=>o.bid=t),placeholder:"请输入商品编号"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(r,{label:"商品名称",prop:"name"},{default:l(()=>[e(p,{modelValue:o.name,"onUpdate:modelValue":a[2]||(a[2]=t=>o.name=t),placeholder:"请输入商品名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(r,{class:"select-clearn",label:"商品规格",prop:"specs"},{default:l(()=>[e(O,{modelValue:o.specs,"onUpdate:modelValue":a[3]||(a[3]=t=>o.specs=t),placeholder:"请选择"},{default:l(()=>[e(M,{label:"件",value:"1"}),e(M,{label:"箱",value:"0"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(c,{span:12},{default:l(()=>[e(r,{label:"商品售价",prop:"price"},{default:l(()=>[e(p,{modelValue:o.price,"onUpdate:modelValue":a[4]||(a[4]=t=>o.price=t),modelModifiers:{number:!0},placeholder:"请输入商品售价"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(c,{span:12},{default:l(()=>[e(r,{label:"生产日期",prop:"birth"},{default:l(()=>[e(Y,{modelValue:o.birth,"onUpdate:modelValue":a[5]||(a[5]=t=>o.birth=t),type:"date",placeholder:"请输入",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(r,{label:"地址",prop:"addr"},{default:l(()=>[e(p,{modelValue:o.addr,"onUpdate:modelValue":a[6]||(a[6]=t=>o.addr=t),placeholder:"请输入地址"},null,8,["modelValue"])]),_:1})]),_:1}),e(h,null,{default:l(()=>[e(c,{span:12},{default:l(()=>[e(r,{label:"数量",prop:"stock"},{default:l(()=>[e(p,{modelValue:o.stock,"onUpdate:modelValue":a[7]||(a[7]=t=>o.stock=t),modelModifiers:{number:!0},placeholder:"请输入数量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(h,{style:{"justify-content":"flex-end"}},{default:l(()=>[e(r,null,{default:l(()=>[e(u,{type:"primary",onClick:j},{default:l(()=>[_("确认")]),_:1}),e(u,{type:"primary",onClick:I},{default:l(()=>[_("取消")]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}},de=J(ae,[["__scopeId","data-v-4fadcc2b"]]);export{de as default};
